# Syntax can be found at https://github.com/anishathalye/dotbot

# Meta defaults we want everywhere
- defaults:
    link:
        create: true

- clean: ['~']


  
### vim ###
- shell:
    - [git submodule update --init --recursive "vim/vim-plug", Installing vim-plug]
- link:
    ~/.vimrc: vim/vimrc
    ~/.vim/ftplugin: vim/ftplugin
    ~/.vim/ftdetect: vim/ftdetect
    ~/.vim/autoload/plug.vim: vim/vim-plug/plug.vim

#### Homebrew ####
- shell:

    # Get Homebrew setup
    -
        command: 'brew --version || ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"'
        description: Installing Homebrew
    -
        command: "brew tap homebrew/bundle"
        description: Installing Brewfileabilityness

    # Update Homebrew if we're just touching up
    -
        command: brew update
        description: Update Homebrew
        stdout: true
        stderr: true

    # Install _All_ the things!
    -
        command: "brew bundle --file=homebrew/Brewfile"
        description: Install _All_ the brewlings!
        stdout: true
        stderr: true

    # Link the apps.
    -
        command: brew linkapps
        description: Link any brewed `/Application`s
        stdout: true
        stderr: true

#### fish ####
- link:
    ~/.config/fish/config.fish: fish/config.fish

- shell:
    # Add fish to the allowed shells
    -
        command: "cat /etc/shells | grep $(which fish) || echo $(which fish) | sudo tee -a /etc/shells"
        description: Ensure fish can shell
    -
        command: "echo $SHELL | grep $(which fish) || chsh -s $(which fish)"
        description: Set fish as shell

#### git ####
- link:
    ~/.config/git/ignore: git/config/.gitignore
    ~/.config/git/config: git/config/.gitconfig

#### Xcode ####
- link:
    ~/Library/Preferences/com.apple.dt.Xcode.plist: Xcode/com.apple.dt.Xcode.plist

- shell:
    # Nukes the plist cache so that anything set in link will get correctly read
    -
        - killall -u zak cfprefsd
        - Nuke plist cache

